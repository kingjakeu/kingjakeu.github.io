---
title: "자바 코드를 실행하면 벌어지는 일"
date: 2020-08-11 20:35:00 +0900
category: java
lastmod : 2020-08-11 20:35:00 +0900
sitemap :
  changefreq : weekly
  priority : 1.0
---

<br>

여기 간단하게 작성된 자바 코드가 하나 있다.

```java
public class Main{
    public static void main(String[] args){
      System.out.println("hello world!");
    }
}
```

이 자바 파일을 실행 하면 벌어지는 일은 다음과 같다.  
  
1. 자바 코드를 javac로 자바 바이트 코드로 컴파일 한다.
2. 컴파일된 자바 바이트 코드를 클래스 로더에 의해 런타임 데이터 영역에 로드한다.
3. 실행 엔진이 메모리에 로딩된 바이트 코드를 기계어로 바꾸어 명령어 단위로 실행 한다.

### 1. javac 컴파일

Java Source(`.java`)는 **Java Complier(javac)**에 의해 자바 코드 파일(`.java`)에서 자바 바이트코드(`.class`)로 **컴파일** 된다.

---

### 2. 클래스 로더

컴파일된 바이트코드는 JVM에 클래스로더에 전달된다.  
클래스 로더는 애플리케이션 **런타임 중** 필요한 클래스 파일들을 **동적으로 런타임 데이터 영역 (JVM의 메모리)에 로딩**한다.  
  
[자세한 클래스로더 설명](https://kingjakeu.github.io/study/2020/08/10/class-loader/)

---

### 3. 실행 엔진 Execution Engine

실행엔진은 클래스 로더를 통해 **런타임 데이터 영역에 배치된 바이트 코드들를 명령어 단위로 읽어서 실행**한다.  
자바 바이트코드는 기계가 바로 수행할 수 있는 언어보다는 인간이 읽기 편한 언어에 가깝기 때문에, **실행 엔진은 자바 바이트코드들을 JVM 내부에서 기계가 실행 할 수 있는 형태로 변경**한다.  
  
이때 JVM은 **인터프리터**와 **JIT(Just-In-Time)컴파일러**를 사용한다.  
  
**인터프리터**는 바이트 코드 명령어를 하나씩 읽어서 네이티브 코드로 변환하고 실행한다. **인터프리팅 방식으로 해석은 빠르나, 실행시간이 길고 느리다**.  
  
인터프리터의 단점을 보완하기 위해 **JVM은 JIT 컴파일러를 사용**한다. JIT 컴파일러는 **자주 사용되는 클래스나 메소드의 바이트 코드 전체를 컴파일 하여 네이티브 코드로 바꾼다**. 그리고 해당 **네이티브 코드를 캐시에 보관**한다. 캐시에 보관된 네이티브 코드는 이후 향상된 성능으로 빠르게 수행된다.